document.querySelector(".control-buttons span").onclick=function(){let e=prompt("ماهو أسمك ؟");null==e||""==e?document.querySelector(".name span").innerHTML="الاسم غير معروف :(":document.querySelector(".name span").innerHTML=e,document.querySelector(".control-buttons").remove(),revealBlocks(),startGame()};let timer,elapsedTime=0,duration=1e3,blocksContainer=document.querySelector(".spacetoon-game-blocks"),blocks=Array.from(blocksContainer.children),orderRange=Array.from(Array(blocks.length).keys());function flipBlock(e){e.classList.add("is-flipped");let s=blocks.filter(e=>e.classList.contains("is-flipped"));2===s.length&&(stopClicking(),checkmatchedBlooks(s[0],s[1]))}function startGame(){timer=setInterval(function(){elapsedTime++},1e3)}function stopClicking(){blocksContainer.classList.add("no-clicking"),setTimeout(()=>{blocksContainer.classList.remove("no-clicking")},duration)}function checkmatchedBlooks(e,s){let l=document.querySelector(".tries span"),t=document.querySelector(".elapsed-time");if(e.dataset.spacetoon===s.dataset.spacetoon){if(document.getElementById("success").play(),e.classList.remove("is-flipped"),s.classList.remove("is-flipped"),allBlocksMatched(),e.classList.add("has-match"),s.classList.add("has-match"),allBlocksMatched()){clearInterval(timer),t.innerHTML=elapsedTime;document.querySelector(".end-game-message").style.display="block",document.getElementById("ad_spacetoon").play()}}else l.innerHTML=parseInt(l.innerHTML)+1,(errorCount=l.innerHTML)>15?l.style.background="#C51605":errorCount>10?l.style.background="#FFA41B":l.style.background="#FFCC70",setTimeout(()=>{e.classList.remove("is-flipped"),s.classList.remove("is-flipped")},duration),document.getElementById("fail").play()}function revealBlocks(){blocks.forEach(e=>{e.classList.add("is-flipped")}),document.getElementById("player").play(),setTimeout(()=>{blocks.forEach(e=>{e.classList.remove("is-flipped")})},1e3)}function shuffla(e){let s=e.length,l,t;for(;s>0;)t=Math.floor(Math.random()*s),l=e[--s],e[s]=e[t],e[t]=l;return e}function allBlocksMatched(){return blocks.every(e=>e.classList.contains("has-match"))}function resetBlocks(){let e=document.querySelector(".tries span"),s=document.querySelector(".end-game-message");e.style.background="green",blocks.forEach(e=>{e.classList.remove("is-flipped"),e.classList.remove("has-match")}),shuffla(orderRange),blocks.forEach((l,t)=>{l.style.order=orderRange[t],e.innerHTML="0",s.style.display="none",document.getElementById("ad_spacetoon").pause(),elapsedTime=0,e.innerHTML="0"})}shuffla(orderRange),blocks.forEach((e,s)=>{e.style.order=orderRange[s],e.addEventListener("click",function(){flipBlock(e)})});